# åšå®¢ç³»ç»ŸæŠ€æœ¯æ¶æ„æ–‡æ¡£

## 1. Architecture design

```mermaid
graph TD
  A[ç”¨æˆ·æµè§ˆå™¨] --> B[Reactå‰ç«¯åº”ç”¨]
  B --> C[Expressåç«¯API]
  C --> D[SQLiteæ•°æ®åº“]
  C --> E[JWTè®¤è¯æœåŠ¡]
  C --> F[æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ]

  subgraph "å‰ç«¯å±‚"
    B
  end

  subgraph "åç«¯å±‚"
    C
    E
    F
  end

  subgraph "æ•°æ®å±‚"
    D
  end
```

## 2. Technology Description

* å‰ç«¯: React\@18 + TypeScript + Tailwind CSS + Vite + React Router

* åç«¯: Express\@4 + TypeScript + JWTè®¤è¯

* æ•°æ®åº“: SQLite\@3

* å¼€å‘å·¥å…·: ESLint + Prettier + Husky

## 3. Route definitions

| Route              | Purpose               |
| ------------------ | --------------------- |
| /                  | é¦–é¡µï¼Œå±•ç¤ºæ–‡ç« åˆ—è¡¨å’Œå¯¼èˆª          |
| /login             | ç™»å½•é¡µé¢ï¼Œç”¨æˆ·èº«ä»½éªŒè¯           |
| /register          | æ³¨å†Œé¡µé¢ï¼Œæ–°ç”¨æˆ·æ³¨å†Œ            |
| /profile           | ç”¨æˆ·ä¸­å¿ƒï¼Œä¸ªäººä¿¡æ¯å’Œæ–‡ç« ç®¡ç†        |
| /dashboard         | ç”¨æˆ·ä»ªè¡¨æ¿ï¼Œæ–‡ç« ç®¡ç†å’Œæ•°æ®æ¦‚è§ˆ       |
| /articles          | æ–‡ç« åˆ—è¡¨é¡µé¢ï¼Œæ”¯æŒåˆ†ç±»ã€æ ‡ç­¾ç­›é€‰å’Œæœç´¢   |
| /articles/new      | åˆ›å»ºæ–°æ–‡ç« é¡µé¢               |
| /articles/:id      | æ–‡ç« è¯¦æƒ…é¡µé¢ï¼Œæ˜¾ç¤ºæ–‡ç« å†…å®¹å’Œè¯„è®º      |
| /articles/:id/edit | ç¼–è¾‘æ–‡ç« é¡µé¢                |
| /write             | æ–‡ç« ç¼–è¾‘é¡µï¼Œåˆ›å»ºå’Œç¼–è¾‘æ–‡ç« ï¼ˆå…¼å®¹æ—§è·¯ç”±ï¼‰  |
| /edit/:id          | ç¼–è¾‘æŒ‡å®šæ–‡ç« ï¼ˆå…¼å®¹æ—§è·¯ç”±ï¼‰         |
| /categories        | åˆ†ç±»ç®¡ç†é¡µé¢                |
| /categories/:id    | ç‰¹å®šåˆ†ç±»çš„æ–‡ç« åˆ—è¡¨             |
| /category/:name    | åˆ†ç±»é¡µé¢ï¼Œæ˜¾ç¤ºç‰¹å®šåˆ†ç±»çš„æ–‡ç« ï¼ˆå…¼å®¹æ—§è·¯ç”±ï¼‰ |
| /tags              | æ ‡ç­¾ç®¡ç†é¡µé¢                |
| /tags/:id          | ç‰¹å®šæ ‡ç­¾çš„æ–‡ç« åˆ—è¡¨             |
| /tag/:name         | æ ‡ç­¾é¡µé¢ï¼Œæ˜¾ç¤ºç‰¹å®šæ ‡ç­¾çš„æ–‡ç« ï¼ˆå…¼å®¹æ—§è·¯ç”±ï¼‰ |
| /search            | æœç´¢é¡µé¢ï¼Œæ–‡ç« æœç´¢åŠŸèƒ½           |
| /user/:id          | ç”¨æˆ·å…¬å¼€èµ„æ–™é¡µé¢              |
| /admin             | ç®¡ç†å‘˜åå°é¦–é¡µ               |
| /admin/articles    | æ–‡ç« ç®¡ç†åå°                |
| /admin/categories  | åˆ†ç±»ç®¡ç†åå°                |
| /admin/tags        | æ ‡ç­¾ç®¡ç†åå°                |
| /admin/users       | ç”¨æˆ·ç®¡ç†åå°                |
| /admin/comments    | è¯„è®ºç®¡ç†åå°                |
| /about             | å…³äºé¡µé¢ï¼Œåšå®¢ä»‹ç»             |

## 4. API definitions

### 4.1 Core API

**ç”¨æˆ·è®¤è¯ç›¸å…³**

```
POST /api/auth/register
```

Request:

| Param Name | Param Type | isRequired | Description |
| ---------- | ---------- | ---------- | ----------- |
| email      | string     | true       | ç”¨æˆ·é‚®ç®±åœ°å€      |
| password   | string     | true       | ç”¨æˆ·å¯†ç         |
| username   | string     | true       | ç”¨æˆ·æ˜µç§°        |

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| success    | boolean    | æ³¨å†Œæ˜¯å¦æˆåŠŸ      |
| message    | string     | å“åº”æ¶ˆæ¯        |
| token      | string     | JWTä»¤ç‰Œ       |

```
POST /api/auth/login
```

Request:

| Param Name | Param Type | isRequired | Description |
| ---------- | ---------- | ---------- | ----------- |
| email      | string     | true       | ç”¨æˆ·é‚®ç®±        |
| password   | string     | true       | ç”¨æˆ·å¯†ç         |

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| success    | boolean    | ç™»å½•æ˜¯å¦æˆåŠŸ      |
| token      | string     | JWTä»¤ç‰Œ       |
| user       | object     | ç”¨æˆ·ä¿¡æ¯        |

**æ–‡ç« ç®¡ç†ç›¸å…³**

```
GET /api/articles
```

Query Parameters:

| Param Name | Param Type | isRequired | Description                               |
| ---------- | ---------- | ---------- | ----------------------------------------- |
| page       | number     | false      | é¡µç ï¼Œé»˜è®¤1                                    |
| limit      | number     | false      | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10                                 |
| category   | string     | false      | åˆ†ç±»ç­›é€‰                                      |
| tag        | string     | false      | æ ‡ç­¾ç­›é€‰                                      |
| author     | string     | false      | ä½œè€…ç­›é€‰                                      |
| status     | string     | false      | çŠ¶æ€ç­›é€‰(draft/published/archived)            |
| sort       | string     | false      | æ’åºæ–¹å¼(created\_at/updated\_at/views/likes) |
| order      | string     | false      | æ’åºé¡ºåº(asc/desc)                            |
| search     | string     | false      | æœç´¢å…³é”®è¯                                     |

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| articles   | array      | æ–‡ç« åˆ—è¡¨        |
| total      | number     | æ–‡ç« æ€»æ•°        |
| page       | number     | å½“å‰é¡µç         |
| totalPages | number     | æ€»é¡µæ•°         |
| filters    | object     | å½“å‰ç­›é€‰æ¡ä»¶      |

```
POST /api/articles
```

Request:

| Param Name  | Param Type | isRequired | Description                   |
| ----------- | ---------- | ---------- | ----------------------------- |
| title       | string     | true       | æ–‡ç« æ ‡é¢˜(1-100å­—ç¬¦)                 |
| content     | string     | true       | æ–‡ç« å†…å®¹(Markdownæ ¼å¼)              |
| summary     | string     | false      | æ–‡ç« æ‘˜è¦(æœ€å¤š200å­—ç¬¦)                 |
| categoryId  | number     | false      | åˆ†ç±»ID                          |
| tags        | array      | false      | æ ‡ç­¾IDæ•°ç»„                        |
| status      | string     | false      | å‘å¸ƒçŠ¶æ€(draft/published/private) |
| coverImage  | string     | false      | å°é¢å›¾ç‰‡URL                       |
| publishTime | string     | false      | å®šæ—¶å‘å¸ƒæ—¶é—´                        |

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| success    | boolean    | åˆ›å»ºæ˜¯å¦æˆåŠŸ      |
| article    | object     | åˆ›å»ºçš„æ–‡ç« ä¿¡æ¯     |
| message    | string     | å“åº”æ¶ˆæ¯        |

```
GET /api/articles/:id
```

Response:

| Param Name  | Param Type | Description                |
| ----------- | ---------- | -------------------------- |
| id          | number     | æ–‡ç« ID                       |
| title       | string     | æ–‡ç« æ ‡é¢˜                       |
| content     | string     | æ–‡ç« å†…å®¹                       |
| summary     | string     | æ–‡ç« æ‘˜è¦                       |
| author      | object     | ä½œè€…ä¿¡æ¯(id, username, avatar) |
| category    | object     | åˆ†ç±»ä¿¡æ¯(id, name)             |
| tags        | array      | æ ‡ç­¾åˆ—è¡¨                       |
| status      | string     | å‘å¸ƒçŠ¶æ€                       |
| coverImage  | string     | å°é¢å›¾ç‰‡                       |
| views       | number     | é˜…è¯»é‡                        |
| likes       | number     | ç‚¹èµæ•°                        |
| createdAt   | string     | åˆ›å»ºæ—¶é—´                       |
| updatedAt   | string     | æ›´æ–°æ—¶é—´                       |
| publishTime | string     | å‘å¸ƒæ—¶é—´                       |

```
PUT /api/articles/:id
```

Request: (åŒPOST /api/articles)

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| success    | boolean    | æ›´æ–°æ˜¯å¦æˆåŠŸ      |
| article    | object     | æ›´æ–°åçš„æ–‡ç« ä¿¡æ¯    |
| message    | string     | å“åº”æ¶ˆæ¯        |

```
DELETE /api/articles/:id
```

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| success    | boolean    | åˆ é™¤æ˜¯å¦æˆåŠŸ      |
| message    | string     | å“åº”æ¶ˆæ¯        |

```
POST /api/articles/:id/like
```

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| success    | boolean    | ç‚¹èµæ˜¯å¦æˆåŠŸ      |
| likes      | number     | å½“å‰ç‚¹èµæ•°       |
| isLiked    | boolean    | å½“å‰ç”¨æˆ·æ˜¯å¦å·²ç‚¹èµ   |

**åˆ†ç±»ç®¡ç†ç›¸å…³**

```
GET /api/categories
```

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| categories | array      | åˆ†ç±»åˆ—è¡¨        |
| total      | number     | åˆ†ç±»æ€»æ•°        |

```
POST /api/categories
```

Request:

| Param Name  | Param Type | isRequired | Description   |
| ----------- | ---------- | ---------- | ------------- |
| name        | string     | true       | åˆ†ç±»åç§°(1-20å­—ç¬¦)  |
| description | string     | false      | åˆ†ç±»æè¿°(æœ€å¤š100å­—ç¬¦) |
| icon        | string     | false      | åˆ†ç±»å›¾æ ‡          |
| sortOrder   | number     | false      | æ’åºæƒé‡          |

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| success    | boolean    | åˆ›å»ºæ˜¯å¦æˆåŠŸ      |
| category   | object     | åˆ›å»ºçš„åˆ†ç±»ä¿¡æ¯     |
| message    | string     | å“åº”æ¶ˆæ¯        |

```
PUT /api/categories/:id
```

Request: (åŒPOST /api/categories)

```
DELETE /api/categories/:id
```

Query Parameters:

| Param Name     | Param Type | isRequired | Description |
| -------------- | ---------- | ---------- | ----------- |
| moveToCategory | number     | false      | å°†æ–‡ç« ç§»åŠ¨åˆ°çš„åˆ†ç±»ID |

**æ ‡ç­¾ç®¡ç†ç›¸å…³**

```
GET /api/tags
```

Query Parameters:

| Param Name | Param Type | isRequired | Description                   |
| ---------- | ---------- | ---------- | ----------------------------- |
| sort       | string     | false      | æ’åºæ–¹å¼(name/useCount/createdAt) |
| search     | string     | false      | æœç´¢æ ‡ç­¾åç§°                        |

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| tags       | array      | æ ‡ç­¾åˆ—è¡¨        |
| total      | number     | æ ‡ç­¾æ€»æ•°        |

```
POST /api/tags
```

Request:

| Param Name  | Param Type | isRequired | Description  |
| ----------- | ---------- | ---------- | ------------ |
| name        | string     | true       | æ ‡ç­¾åç§°(1-15å­—ç¬¦) |
| color       | string     | false      | æ ‡ç­¾é¢œè‰²(HEXæ ¼å¼)  |
| description | string     | false      | æ ‡ç­¾æè¿°(æœ€å¤š50å­—ç¬¦) |

```
PUT /api/tags/:id
```

Request: (åŒPOST /api/tags)

```
DELETE /api/tags/:id
```

```
POST /api/tags/merge
```

Request:

| Param Name   | Param Type | isRequired | Description |
| ------------ | ---------- | ---------- | ----------- |
| sourceTagIds | array      | true       | è¦åˆå¹¶çš„æ ‡ç­¾IDæ•°ç»„  |
| targetTagId  | number     | true       | ç›®æ ‡æ ‡ç­¾ID      |

**æœç´¢ç›¸å…³**

```
GET /api/search
```

Query Parameters:

| Param Name | Param Type | isRequired | Description                 |
| ---------- | ---------- | ---------- | --------------------------- |
| q          | string     | true       | æœç´¢å…³é”®è¯                       |
| type       | string     | false      | æœç´¢ç±»å‹(all/title/content/tag) |
| category   | string     | false      | åˆ†ç±»ç­›é€‰                        |
| tag        | string     | false      | æ ‡ç­¾ç­›é€‰                        |
| dateRange  | string     | false      | æ—¶é—´èŒƒå›´(week/month/year)       |
| page       | number     | false      | é¡µç                           |
| limit      | number     | false      | æ¯é¡µæ•°é‡                        |

Response:

| Param Name  | Param Type | Description |
| ----------- | ---------- | ----------- |
| results     | array      | æœç´¢ç»“æœ        |
| total       | number     | ç»“æœæ€»æ•°        |
| suggestions | array      | æœç´¢å»ºè®®        |
| highlights  | object     | å…³é”®è¯é«˜äº®ä¿¡æ¯     |

**è¯„è®ºç³»ç»Ÿç›¸å…³**

```
GET /api/articles/:id/comments
```

Response:

| Param Name | Param Type | Description |
| ---------- | ---------- | ----------- |
| comments   | array      | è¯„è®ºåˆ—è¡¨        |
| total      | number     | è¯„è®ºæ€»æ•°        |

```
POST /api/articles/:id/comments
```

Request:

| Param Name | Param Type | isRequired | Description |
| ---------- | ---------- | ---------- | ----------- |
| content    | string     | true       | è¯„è®ºå†…å®¹        |
| parentId   | number     | false      | çˆ¶è¯„è®ºID(å›å¤)   |

## 5. Server architecture diagram

```mermaid
graph TD
  A[å®¢æˆ·ç«¯è¯·æ±‚] --> B[è·¯ç”±å±‚ Router]
  B --> C[ä¸­é—´ä»¶å±‚ Middleware]
  C --> D[æ§åˆ¶å™¨å±‚ Controller]
  D --> E[æœåŠ¡å±‚ Service]
  E --> F[æ•°æ®è®¿é—®å±‚ Repository]
  F --> G[(SQLiteæ•°æ®åº“)]

  subgraph "ExpressæœåŠ¡å™¨"
    B
    C
    D
    E
    F
  end

  subgraph "ä¸­é—´ä»¶"
    H[CORSä¸­é—´ä»¶]
    I[JWTè®¤è¯ä¸­é—´ä»¶]
    J[æ—¥å¿—ä¸­é—´ä»¶]
    K[é”™è¯¯å¤„ç†ä¸­é—´ä»¶]
  end

  C --> H
  C --> I
  C --> J
  C --> K
```

## 6. Data model

### 6.1 Data model definition

```mermaid
erDiagram
  USERS ||--o{ ARTICLES : creates
  USERS ||--o{ COMMENTS : writes
  ARTICLES ||--o{ COMMENTS : has
  ARTICLES ||--o{ ARTICLE_TAGS : tagged
  TAGS ||--o{ ARTICLE_TAGS : used
  CATEGORIES ||--o{ ARTICLES : contains
  COMMENTS ||--o{ COMMENTS : replies

  USERS {
    int id PK
    string email UK
    string password_hash
    string username
    string avatar
    string bio
    string role
    datetime created_at
    datetime updated_at
  }

  ARTICLES {
    int id PK
    string title
    text content
    string summary
    int author_id FK
    int category_id FK
    string status
    string cover_image
    string slug
    boolean is_featured
    datetime publish_time
    int views
    int likes
    int comments_count
    text meta_description
    text meta_keywords
    datetime created_at
    datetime updated_at
  }

  COMMENTS {
    int id PK
    text content
    int user_id FK
    int article_id FK
    int parent_id FK
    int likes
    datetime created_at
    datetime updated_at
  }

  CATEGORIES {
    int id PK
    string name UK
    string description
    string icon
    string slug
    int sort_order
    int article_count
    datetime created_at
    datetime updated_at
  }

  TAGS {
    int id PK
    string name UK
    string description
    string color
    string slug
    int use_count
    datetime created_at
    datetime updated_at
  }

  ARTICLE_TAGS {
    int article_id FK
    int tag_id FK
  }
```

### 6.2 Data Definition Language

**ç”¨æˆ·è¡¨ (users)**

```sql
-- åˆ›å»ºç”¨æˆ·è¡¨
CREATE TABLE users (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  username VARCHAR(100) NOT NULL,
  avatar VARCHAR(255) DEFAULT NULL,
  bio TEXT DEFAULT NULL,
  role VARCHAR(20) DEFAULT 'user' CHECK (role IN ('user', 'author', 'admin')),
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_username ON users(username);
```

**åˆ†ç±»è¡¨ (categories)**

```sql
-- åˆ›å»ºåˆ†ç±»è¡¨
CREATE TABLE categories (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name VARCHAR(100) UNIQUE NOT NULL,
  description TEXT DEFAULT NULL,
  icon VARCHAR(100) DEFAULT NULL,
  slug VARCHAR(100) UNIQUE NOT NULL,
  sort_order INTEGER DEFAULT 0,
  article_count INTEGER DEFAULT 0,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_categories_slug ON categories(slug);
CREATE INDEX idx_categories_sort_order ON categories(sort_order);

-- åˆå§‹åŒ–åˆ†ç±»æ•°æ®
INSERT INTO categories (name, description, icon, slug, sort_order) VALUES
('æŠ€æœ¯', 'æŠ€æœ¯ç›¸å…³æ–‡ç« ', 'ğŸ’»', 'tech', 1),
('ç”Ÿæ´»', 'ç”Ÿæ´»æ„Ÿæ‚Ÿå’Œæ—¥å¸¸', 'ğŸŒ±', 'life', 2),
('è¯»ä¹¦', 'è¯»ä¹¦ç¬”è®°å’Œä¹¦è¯„', 'ğŸ“š', 'reading', 3),
('æ—…è¡Œ', 'æ—…è¡Œæ¸¸è®°å’Œæ”»ç•¥', 'âœˆï¸', 'travel', 4),
('éšç¬”', 'éšæƒ³å’Œæ‚è®°', 'âœï¸', 'essay', 5);
```

**æ ‡ç­¾è¡¨ (tags)**

```sql
-- åˆ›å»ºæ ‡ç­¾è¡¨
CREATE TABLE tags (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name VARCHAR(50) UNIQUE NOT NULL,
  description TEXT DEFAULT NULL,
  color VARCHAR(7) DEFAULT '#3B82F6',
  slug VARCHAR(50) UNIQUE NOT NULL,
  use_count INTEGER DEFAULT 0,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_tags_slug ON tags(slug);
CREATE INDEX idx_tags_use_count ON tags(use_count DESC);
CREATE INDEX idx_tags_name ON tags(name);

-- åˆå§‹åŒ–æ ‡ç­¾æ•°æ®
INSERT INTO tags (name, description, color, slug) VALUES
('JavaScript', 'JavaScriptç¼–ç¨‹è¯­è¨€', '#F7DF1E', 'javascript'),
('React', 'Reactå‰ç«¯æ¡†æ¶', '#61DAFB', 'react'),
('TypeScript', 'TypeScriptç¼–ç¨‹è¯­è¨€', '#3178C6', 'typescript'),
('Node.js', 'Node.jsåç«¯æŠ€æœ¯', '#339933', 'nodejs'),
('å‰ç«¯', 'å‰ç«¯å¼€å‘æŠ€æœ¯', '#FF6B6B', 'frontend'),
('åç«¯', 'åç«¯å¼€å‘æŠ€æœ¯', '#4ECDC4', 'backend'),
('æ•°æ®åº“', 'æ•°æ®åº“ç›¸å…³æŠ€æœ¯', '#FF9500', 'database'),
('ç®—æ³•', 'ç®—æ³•å’Œæ•°æ®ç»“æ„', '#8E44AD', 'algorithm'),
('è®¾è®¡æ¨¡å¼', 'è½¯ä»¶è®¾è®¡æ¨¡å¼', '#2ECC71', 'design-pattern'),
('æ€§èƒ½ä¼˜åŒ–', 'æ€§èƒ½ä¼˜åŒ–æŠ€å·§', '#E74C3C', 'performance'),
('å¼€æºé¡¹ç›®', 'å¼€æºé¡¹ç›®åˆ†äº«', '#34495E', 'opensource'),
('å­¦ä¹ ç¬”è®°', 'å­¦ä¹ å¿ƒå¾—ç¬”è®°', '#95A5A6', 'notes'),
('Vue.js', 'Vue.jså‰ç«¯æ¡†æ¶', '#4FC08D', 'vuejs'),
('Python', 'Pythonç¼–ç¨‹è¯­è¨€', '#3776AB', 'python'),
('Docker', 'å®¹å™¨åŒ–æŠ€æœ¯', '#2496ED', 'docker'),
('Git', 'ç‰ˆæœ¬æ§åˆ¶å·¥å…·', '#F05032', 'git');
```

**æ–‡ç« è¡¨ (articles)**

```sql
-- åˆ›å»ºæ–‡ç« è¡¨
CREATE TABLE articles (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title VARCHAR(255) NOT NULL,
  content TEXT NOT NULL,
  summary TEXT DEFAULT NULL,
  author_id INTEGER NOT NULL,
  category_id INTEGER DEFAULT NULL,
  status VARCHAR(20) DEFAULT 'draft' CHECK (status IN ('draft', 'published', 'archived', 'private')),
  cover_image VARCHAR(500) DEFAULT NULL,
  slug VARCHAR(255) UNIQUE DEFAULT NULL,
  is_featured BOOLEAN DEFAULT FALSE,
  publish_time DATETIME DEFAULT NULL,
  views INTEGER DEFAULT 0,
  likes INTEGER DEFAULT 0,
  comments_count INTEGER DEFAULT 0,
  meta_description TEXT DEFAULT NULL,
  meta_keywords TEXT DEFAULT NULL,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (author_id) REFERENCES users(id) ON DELETE CASCADE,
  FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE SET NULL
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_articles_author_id ON articles(author_id);
CREATE INDEX idx_articles_category_id ON articles(category_id);
CREATE INDEX idx_articles_status ON articles(status);
CREATE INDEX idx_articles_slug ON articles(slug);
CREATE INDEX idx_articles_is_featured ON articles(is_featured);
CREATE INDEX idx_articles_publish_time ON articles(publish_time DESC);
CREATE INDEX idx_articles_created_at ON articles(created_at DESC);
CREATE INDEX idx_articles_views ON articles(views DESC);
CREATE INDEX idx_articles_likes ON articles(likes DESC);

-- åˆ›å»ºå…¨æ–‡æœç´¢ç´¢å¼•ï¼ˆå¦‚æœæ”¯æŒï¼‰
-- CREATE VIRTUAL TABLE articles_fts USING fts5(title, content, summary);
```

**æ–‡ç« æ ‡ç­¾å…³è”è¡¨ (article\_tags)**

```sql
-- åˆ›å»ºæ–‡ç« æ ‡ç­¾å…³è”è¡¨
CREATE TABLE article_tags (
  article_id INTEGER NOT NULL,
  tag_id INTEGER NOT NULL,
  PRIMARY KEY (article_id, tag_id),
  FOREIGN KEY (article_id) REFERENCES articles(id) ON DELETE CASCADE,
  FOREIGN KEY (tag_id) REFERENCES tags(id) ON DELETE CASCADE
);
```

**è¯„è®ºè¡¨ (comments)**

```sql
-- åˆ›å»ºè¯„è®ºè¡¨
CREATE TABLE comments (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  content TEXT NOT NULL,
  user_id INTEGER NOT NULL,
  article_id INTEGER NOT NULL,
  parent_id INTEGER DEFAULT NULL,
  likes INTEGER DEFAULT 0,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
  FOREIGN KEY (article_id) REFERENCES articles(id) ON DELETE CASCADE,
  FOREIGN KEY (parent_id) REFERENCES comments(id) ON DELETE CASCADE
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_comments_user_id ON comments(user_id);
CREATE INDEX idx_comments_article_id ON comments(article_id);
CREATE INDEX idx_comments_parent_id ON comments(parent_id);
CREATE INDEX idx_comments_created_at ON comments(created_at DESC);
```

**åˆå§‹åŒ–ç”¨æˆ·æ•°æ®**

```sql
-- åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜è´¦å·
-- å¯†ç : admin123 (BCryptåŠ å¯†åçš„å“ˆå¸Œå€¼)
INSERT INTO users (email, password_hash, username, role, bio) VALUES
('admin@blog.com', '$2b$10$rOzJqQjQjQjQjQjQjQjQjOeKKF.Sb8z8z8z8z8z8z8z8z8z8z8z8z8', 'Admin', 'admin', 'ç³»ç»Ÿç®¡ç†å‘˜'),
('demo@blog.com', '$2b$10$rOzJqQjQjQjQjQjQjQjQjOeKKF.Sb8z8z8z8z8z8z8z8z8z8z8z8z8', 'Demoç”¨æˆ·', 'author', 'æ¼”ç¤ºåšä¸»è´¦å·'),
('user@blog.com', '$2b$10$rOzJqQjQjQjQjQjQjQjQjOeKKF.Sb8z8z8z8z8z8z8z8z8z8z8z8z8', 'æ™®é€šç”¨æˆ·', 'user', 'æ™®é€šæ³¨å†Œç”¨æˆ·');

-- åˆ›å»ºç¤ºä¾‹æ–‡ç« 
INSERT INTO articles (title, content, summary, author_id, category_id, status, views, likes) VALUES
('æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢', '# æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢\n\nè¿™æ˜¯ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œç”¨äºæµ‹è¯•åšå®¢ç³»ç»Ÿçš„åŸºæœ¬åŠŸèƒ½ã€‚\n\n## åŠŸèƒ½ç‰¹ç‚¹\n\n- æ”¯æŒMarkdownç¼–è¾‘\n- ç”¨æˆ·è®¤è¯ç³»ç»Ÿ\n- è¯„è®ºåŠŸèƒ½\n- åˆ†ç±»å’Œæ ‡ç­¾\n\nå¸Œæœ›ä½ å–œæ¬¢è¿™ä¸ªåšå®¢ç³»ç»Ÿï¼', 'åšå®¢ç³»ç»Ÿçš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä»‹ç»åŸºæœ¬åŠŸèƒ½', 2, 1, 'published', 100, 5),
('Reactå¼€å‘æœ€ä½³å®è·µ', '# Reactå¼€å‘æœ€ä½³å®è·µ\n\næœ¬æ–‡æ€»ç»“äº†Reactå¼€å‘ä¸­çš„ä¸€äº›æœ€ä½³å®è·µ...', 'Reactå¼€å‘ç»éªŒåˆ†äº«', 2, 1, 'published', 50, 3),
('æˆ‘çš„è¯»ä¹¦ç¬”è®°', '# æœ€è¿‘è¯»çš„å‡ æœ¬å¥½ä¹¦\n\nåˆ†äº«ä¸€äº›æœ€è¿‘è¯»è¿‡çš„æŠ€æœ¯ä¹¦ç±...', 'æŠ€æœ¯ä¹¦ç±æ¨èå’Œè¯»ä¹¦å¿ƒå¾—', 2, 3, 'draft', 0, 0);

-- åˆ›å»ºæ–‡ç« æ ‡ç­¾å…³è”
INSERT INTO article_tags (article_id, tag_id) VALUES
(1, 1), (1, 2), -- ç¬¬ä¸€ç¯‡æ–‡ç« å…³è”JavaScriptå’ŒReactæ ‡ç­¾
(2, 2), (2, 5), -- ç¬¬äºŒç¯‡æ–‡ç« å…³è”Reactå’Œå‰ç«¯æ ‡ç­¾
(3, 11); -- ç¬¬ä¸‰ç¯‡æ–‡ç« å…³è”å­¦ä¹ ç¬”è®°æ ‡ç­¾

-- åˆ›å»ºç¤ºä¾‹è¯„è®º
INSERT INTO comments (content, user_id, article_id, likes) VALUES
('å¾ˆæ£’çš„åšå®¢ç³»ç»Ÿï¼æœŸå¾…æ›´å¤šåŠŸèƒ½', 3, 1, 2),
('ç•Œé¢å¾ˆç®€æ´ï¼Œç”¨æˆ·ä½“éªŒä¸é”™', 3, 1, 1),
('æ„Ÿè°¢åˆ†äº«ï¼Œå­¦åˆ°äº†å¾ˆå¤š', 3, 2, 3);
```

**è§¦å‘å™¨ - è‡ªåŠ¨æ›´æ–°æ—¶é—´æˆ³**

```sql
-- ç”¨æˆ·è¡¨æ›´æ–°æ—¶é—´è§¦å‘å™¨
CREATE TRIGGER update_users_timestamp 
  AFTER UPDATE ON users
  FOR EACH ROW
  BEGIN
    UPDATE users SET updated_at = CURRENT_TIMESTAMP WHERE id = NEW.id;
  END;

-- æ–‡ç« è¡¨æ›´æ–°æ—¶é—´è§¦å‘å™¨
CREATE TRIGGER update_articles_timestamp 
  AFTER UPDATE ON articles
  FOR EACH ROW
  BEGIN
    UPDATE articles SET updated_at = CURRENT_TIMESTAMP WHERE id = NEW.id;
  END;

-- è¯„è®ºè¡¨æ›´æ–°æ—¶é—´è§¦å‘å™¨
CREATE TRIGGER update_comments_timestamp 
  AFTER UPDATE ON comments
  FOR EACH ROW
  BEGIN
    UPDATE comments SET updated_at = CURRENT_TIMESTAMP WHERE id = NEW.id;
  END;
```

## 7. é»˜è®¤è´¦å·ä¿¡æ¯

### 7.1 ç®¡ç†å‘˜è´¦å·

| å­—æ®µ  | å€¼                | è¯´æ˜             |
| --- | ---------------- | -------------- |
| é‚®ç®±  | <admin@blog.com> | ç®¡ç†å‘˜ç™»å½•é‚®ç®±        |
| å¯†ç   | admin123         | é»˜è®¤å¯†ç ï¼ˆé¦–æ¬¡ç™»å½•åè¯·ä¿®æ”¹ï¼‰ |
| ç”¨æˆ·å | Admin            | ç®¡ç†å‘˜æ˜¾ç¤ºåç§°        |
| è§’è‰²  | admin            | æ‹¥æœ‰æ‰€æœ‰æƒé™         |

### 7.2 æ¼”ç¤ºè´¦å·

| å­—æ®µ  | å€¼               | è¯´æ˜         |
| --- | --------------- | ---------- |
| é‚®ç®±  | <demo@blog.com> | æ¼”ç¤ºåšä¸»è´¦å·     |
| å¯†ç   | demo123         | æ¼”ç¤ºå¯†ç        |
| ç”¨æˆ·å | Demoç”¨æˆ·          | æ¼”ç¤ºåšä¸»åç§°     |
| è§’è‰²  | author          | å¯å‘å¸ƒæ–‡ç« å’Œç®¡ç†è¯„è®º |

### 7.3 æµ‹è¯•è´¦å·

| å­—æ®µ  | å€¼               | è¯´æ˜     |
| --- | --------------- | ------ |
| é‚®ç®±  | <user@blog.com> | æ™®é€šç”¨æˆ·è´¦å· |
| å¯†ç   | user123         | æµ‹è¯•å¯†ç    |
| ç”¨æˆ·å | æ™®é€šç”¨æˆ·            | æ™®é€šç”¨æˆ·åç§° |
| è§’è‰²  | user            | åŸºç¡€ç”¨æˆ·æƒé™ |

